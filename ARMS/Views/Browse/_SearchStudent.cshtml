<div style="position: relative;">
    <div class="page-searchable">
        <div>    
            <div>
                <label>Student Code</label>
            </div>
            <div>
                <div>
                    <input id="textfield-student-code" type="text" placeholder="Student Code" class="main-textfield"/>
                </div>
                <div>
                    <button id="button-search-student" class="main-btn main-btn-second" type="submit">
                        <span>Search Student</span>
                    </button>
                </div>
            </div>
        </div>
        <div>
            <label></label>
        </div>
    </div>
    
    <div id="inquiry-student-partial"></div>
    <div id="error-partial" class="error-partial"></div>
</div>

<script>
    $(document).ready(function() {
        
        const reload = $('div[id$=main-reloading]');
        const inquiryStudentPartial = $('#inquiry-student-partial');
        const errorPartial = $('#error-partial');
        const semesterSelected = $('select[id$=semester]').val();
        const sessionSelected = $('select[id$=session]').val();
        const semesterText = $('select[id$=semester] option:selected').text();
        const sessionText = $('selsect[id$=session] option:selected').text();
        const btnSearchStudent = $('#button-search-student');
        reload.hide();
        
        btnSearchStudent.click(function() {
            const studentCode = $('#textfield-student-code');
            errorPartial.empty();
            reload.show();
            const url = `@Url.Action("InquiryStudent", "Browse")?semesterId=${semesterSelected}&examinationTypeId=${sessionSelected}&studentCode=${studentCode.val().trimEnd()}&semesterText=${semesterText}&sessionText=${sessionText}`;
            console.log(`Checking Inquiry Student URL ${url}`);
            $.ajax({
                type: 'POST',
                url: url,
                cache: true
            }).done(function(res) {
                studentCode.val('');
                inquiryStudentPartial.empty().append(res);
                reload.hide();
            }).fail(function(a, b, c) {
                console.log('It is error');
                console.log(c);
                studentCode.val('');
                loadErrorPage();
            });
        });
        
        
        function loadErrorPage() {
            const url = '@Url.Action("ErrorPage", "Home")';
            $.ajax({
                type: 'GET',
                url: url,
                cache: true
            }).done(function(res) {
                inquiryStudentPartial.empty();
                errorPartial.empty().append(res);
                reload.hide();
            })
        }
    })
</script>
